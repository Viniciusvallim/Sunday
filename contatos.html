<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Colaboradores | Tecparts</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <style>
    body { margin:0; background:#f7f8fa; font-family:'Inter',Arial,sans-serif; color:#222; }
    .header { padding: 20px 40px; background:#236481; color:#fff; display:flex; justify-content:space-between; align-items:center; }
    .header h1 { margin:0; font-weight:800; font-size:1.8rem; }
    .btn { background:#20613c; color:#fff; padding:10px 24px; border-radius:24px; font-size:1rem; font-weight:600; text-decoration:none; transition:.18s; cursor:pointer; border:none; }
    .btn:hover { background:#358f58; }
    .container { padding: 30px 40px; }
    table { width: 100%; border-collapse: collapse; min-width:600px; }
    th, td { padding: 12px 16px; border-bottom: 1px solid #e0e0e0; text-align: left; }
    th { background:#f3f4f6; font-weight:700; color:#546169; }
    tbody tr:hover { background: #e9f6ef; }
    #add-colab-form {
      margin-top: 20px; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      display: none;
      max-width: 500px;
    }
    #add-colab-form label { display: block; margin-bottom: 6px; font-weight: 600; color: #224a2e; }
    #add-colab-form input { width: 100%; padding: 10px 12px; margin-bottom: 16px; border: 1px solid #dde2ea; border-radius: 8px; font-size: 1rem; }
    #form-buttons { display: flex; gap: 12px; justify-content: flex-end; }
    .btn-delete { background: #dc3545; color: #fff; border-radius: 18px; padding: 6px 18px; font-weight: 600; cursor: pointer; border: none; transition: background-color 0.18s; font-size: 0.98rem; margin-left: 12px; }
    .btn-delete:hover { background: #a72631; }
  </style>
  <!-- Firebase Scripts CDN (sempre antes do JS customizado) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
</head>
<body>
  <div class="header">
    <h1>Colaboradores</h1>
    <button onclick="window.location.href='index.html'" class="btn">Voltar</button>
  </div>
  <div class="container">
    <button id="show-form-btn" class="btn">Adicionar Colaborador</button>
    <form id="add-colab-form" autocomplete="off">
      <label for="nome">Nome</label>
      <input type="text" id="nome" name="nome" required placeholder="Nome do colaborador" />
      <label for="email">E-mail</label>
      <input type="email" id="email" name="email" required placeholder="E-mail do colaborador" />
      <div id="form-buttons">
        <button type="submit" class="btn">Salvar</button>
        <button type="button" id="cancel-btn" class="btn" style="background:#dc3545;">Cancelar</button>
      </div>
    </form>
    <table>
      <thead>
        <tr>
          <th>Nome</th>
          <th>E-mail</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody id="colaboradores-tbody">
        <!-- Conteúdo dinâmico -->
      </tbody>
    </table>
  </div>
  <script>
    // INICIALIZAÇÃO DO FIREBASE
    const firebaseConfig = {
      apiKey: "AIzaSyAkbUo-zQiwTPxVspA2nM35nEXmS4rN5C4",
      authDomain: "sunday-a6b04.firebaseapp.com",
      projectId: "sunday-a6b04",
      storageBucket: "sunday-a6b04.appspot.com",
      messagingSenderId: "907213226288",
      appId: "1:907213226288:web:2c9c9fa12a7d76c3b588f5",
      databaseURL: "https://sunday-a6b04-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const tbody = document.getElementById('colaboradores-tbody');
    const showFormBtn = document.getElementById('show-form-btn');
    const addColabForm = document.getElementById('add-colab-form');
    const cancelBtn = document.getElementById('cancel-btn');

    function renderColaboradores(snapshot) {
      tbody.innerHTML = '';
      const colaboradores = [];
      snapshot.forEach(child => {
        const colaborador = child.val();
        colaborador._key = child.key;
        colaboradores.push(colaborador);
      });
      colaboradores.sort((a, b) => a.nome.localeCompare(b.nome, 'pt-BR'));
      colaboradores.forEach(c => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${c.nome}</td>
          <td>${c.email || '-'}</td>
          <td>
            <button class="btn-delete" data-key="${c._key}">Excluir</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
      // Ativa botões de exclusão
      document.querySelectorAll('.btn-delete').forEach(btn => {
        btn.onclick = function () {
          const key = btn.getAttribute('data-key');
          if (confirm('Deseja realmente excluir este colaborador?')) {
            database.ref('colaboradores/' + key).remove();
          }
        }
      });
    }
    // Atualiza em tempo real
    database.ref('colaboradores').on('value', renderColaboradores);

    // Mostrar formulário
    showFormBtn.addEventListener('click', () => {
      addColabForm.style.display = 'block';
      showFormBtn.style.display = 'none';
    });
    // Cancelar
    cancelBtn.addEventListener('click', () => {
      addColabForm.style.display = 'none';
      showFormBtn.style.display = 'inline-block';
      addColabForm.reset && addColabForm.reset();
      addColabForm.querySelector('#nome').value = '';
      addColabForm.querySelector('#email').value = '';
    });
    // Salvar novo colaborador
    addColabForm.addEventListener('submit', e => {
      e.preventDefault();
      const nome = addColabForm.nome.value.trim();
      const email = addColabForm.email.value.trim();
      if (!nome || !email) {
        alert('Preencha os dois campos antes de salvar.');
        return;
      }
      database.ref('colaboradores').push({ nome, email }).then(() => {
        addColabForm.style.display = 'none';
        showFormBtn.style.display = 'inline-block';
        addColabForm.reset();
      });
    });
    /* População inicial (descomente para usar uma vez)
    function popularPadrao() {
      const padrao = [
        { nome: "Maria Silva", email: "maria@email.com" },
        { nome: "João Souza", email: "joao@email.com" }
        // ...adicione outros se quiser
      ];
      padrao.forEach(c => database.ref('colaboradores').push(c));
    }
    // popularPadrao();
    */
  </script>
</body>
</html>
