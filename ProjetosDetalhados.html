<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Projeto Detalhado | Tecparts</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0; background: #f7f8fa;
      font-family: 'Inter', Arial, sans-serif;
      color: #222; display: flex;
      justify-content: center; padding: 40px 0;
    }
    .container {
      background: #fff; border-radius: 8px; box-shadow: 0 3px 12px rgba(0,0,0,0.1);
      max-width: 720px; width: 100%; padding: 24px 32px;
    }
    h1 { color: #2f4f24; font-size: 2rem; margin-bottom: 16px; }
    fieldset {
      border: 1px solid #d0d0d0; border-radius: 6px;
      margin-bottom: 24px; padding: 16px 20px;
    }
    legend {
      padding: 0 8px; font-weight: 600; color: #2f4f24;
      font-size: 1.1rem;
    }
    .group { margin-bottom: 16px; }
    .group label {
      display: block; font-weight: 500; margin-bottom: 6px; color: #333;
    }
    .group input, .group textarea {
      width: 100%; font-size: 0.95rem; padding: 8px 10px;
      border: 1px solid #bbb; border-radius: 4px; background: #fafafa;
    }
    .group textarea { resize: vertical; }
    #btnGerarPdf {
      display: inline-block; background: #2f4f24; color: #fff;
      border: none; padding: 12px 28px; border-radius: 24px;
      font-size: 1rem; font-weight: 600; cursor: pointer;
      transition: background-color .2s ease; margin-top: 8px;
    }
    #btnGerarPdf:hover { background: #4d733a; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>Projeto Detalhado</h1>
    <form id="formProjeto">
      <!-- 1. Iniciação -->
      <fieldset>
        <legend>1. Iniciação do Projeto</legend>
        <div class="group">
          <label for="tap">Termo de Abertura (TAP)</label>
          <textarea id="tap" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="partesInteressadasIni">Registro das Partes Interessadas</label>
          <textarea id="partesInteressadasIni" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="respIniciacao">Responsáveis (vírgula)</label>
          <input type="text" id="respIniciacao" placeholder="Ex: João, Maria">
        </div>
        <div class="group">
          <label for="cientesIniciacao">Cientes (vírgula)</label>
          <input type="text" id="cientesIniciacao" placeholder="Ex: Pedro, Ana">
        </div>
      </fieldset>

      <!-- 2. Planejamento -->
      <fieldset>
        <legend>2. Planejamento</legend>
        <div class="group">
          <label for="planoGerenciamento">Plano de Gerenciamento do Projeto</label>
          <textarea id="planoGerenciamento" rows="2"></textarea>
        </div>
        <div class="group"><label for="escopo">Escopo</label><textarea id="escopo" rows="1"></textarea></div>
        <div class="group"><label for="cronograma">Cronograma</label><textarea id="cronograma" rows="1"></textarea></div>
        <div class="group"><label for="custos">Custos</label><textarea id="custos" rows="1"></textarea></div>
        <div class="group"><label for="qualidade">Qualidade</label><textarea id="qualidade" rows="1"></textarea></div>
        <div class="group"><label for="riscosPlanej">Riscos</label><textarea id="riscosPlanej" rows="1"></textarea></div>
        <div class="group"><label for="comunPlanej">Comunicação</label><textarea id="comunPlanej" rows="1"></textarea></div>
        <div class="group"><label for="recursos">Recursos</label><textarea id="recursos" rows="1"></textarea></div>
        <div class="group"><label for="aquisicoes">Aquisições</label><textarea id="aquisicoes" rows="1"></textarea></div>
        <div class="group"><label for="partesPlanej">Partes Interessadas</label><textarea id="partesPlanej" rows="1"></textarea></div>
        <div class="group">
          <label for="respPlanejamento">Responsáveis (vírgula)</label>
          <input type="text" id="respPlanejamento">
        </div>
        <div class="group">
          <label for="cientesPlanejamento">Cientes (vírgula)</label>
          <input type="text" id="cientesPlanejamento">
        </div>
      </fieldset>

      <!-- 3. Execução & Monitoramento -->
      <fieldset>
        <legend>3. Execução e Monitoramento</legend>
        <div class="group">
          <label for="registroRiscos">Registro de Riscos</label>
          <textarea id="registroRiscos" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="registroProblemas">Issues Log</label>
          <textarea id="registroProblemas" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="registroMudancas">Change Log</label>
          <textarea id="registroMudancas" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="relatoriosStatus">Relatórios de Status/Desempenho</label>
          <textarea id="relatoriosStatus" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="painelKpis">Painel de Indicadores (KPIs)</label>
          <textarea id="painelKpis" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="planoComunicacao">Plano de Comunicação</label>
          <textarea id="planoComunicacao" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="gestaoTarefas">Gestão de Tarefas e Entregas</label>
          <textarea id="gestaoTarefas" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="respExecucao">Responsáveis (vírgula)</label>
          <input type="text" id="respExecucao">
        </div>
        <div class="group">
          <label for="cientesExecucao">Cientes (vírgula)</label>
          <input type="text" id="cientesExecucao">
        </div>
      </fieldset>

      <!-- 4. Encerramento -->
      <fieldset>
        <legend>4. Encerramento</legend>
        <div class="group">
          <label for="termoEncerramento">Termo de Encerramento</label>
          <textarea id="termoEncerramento" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="relatorioFinal">Relatório Final do Projeto</label>
          <textarea id="relatorioFinal" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="licoesAprendidas">Lições Aprendidas</label>
          <textarea id="licoesAprendidas" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="docAceite">Documentação de Aceite das Entregas</label>
          <textarea id="docAceite" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="planoTransicao">Plano de Transição/Operação</label>
          <textarea id="planoTransicao" rows="2"></textarea>
        </div>
        <div class="group">
          <label for="respEncerramento">Responsáveis (vírgula)</label>
          <input type="text" id="respEncerramento">
        </div>
        <div class="group">
          <label for="cientesEncerramento">Cientes (vírgula)</label>
          <input type="text" id="cientesEncerramento">
        </div>
      </fieldset>

      <button type="button" id="btnGerarPdf">Gerar PDF</button>
    </form>
  </div>

  <script>
    const { jsPDF } = window.jspdf;
    document.getElementById('btnGerarPdf').addEventListener('click', () => {
      const doc = new jsPDF({ unit: 'mm', format: 'a4' });
      const f = document.getElementById('formProjeto');
      const W = doc.internal.pageSize.getWidth();
      const margin = 20;
      let y = margin;

      function newPageIfNeeded(h) {
        if (y + h > doc.internal.pageSize.getHeight() - margin) {
          doc.addPage();
          y = margin;
        }
      }

      function sectionHeader(text) {
        newPageIfNeeded(12);
        doc.setFillColor(228, 241, 219);
        doc.rect(margin, y, W - 2*margin, 8, 'F');
        doc.setFontSize(14).setTextColor(47,79,36).setFont('helvetica','bold');
        doc.text(text, margin+2, y+6);
        y += 12;
      }

      function printField(label, id) {
        const v = f[id].value.trim();
        if (!v) return;
        const full = `${label}: ${v}`;
        doc.setFontSize(11).setFont('helvetica','normal').setTextColor(47,79,36);
        const lines = doc.splitTextToSize(full, W - margin*2);
        newPageIfNeeded(lines.length * 7);
        doc.text(lines, margin, y);
        y += lines.length * 7 + 4;
      }

      function printSignatures(label, id) {
        const v = f[id].value.trim();
        if (!v) return;
        const names = v.split(',').map(s=>s.trim()).filter(Boolean);
        names.forEach(name => {
          newPageIfNeeded(20);
          doc.setFontSize(11).setFont('helvetica','bold').setTextColor(47,79,36);
          doc.text(`${label} — ${name}`, margin, y);
          y += 8;               // espaço antes da linha
          doc.setDrawColor(180);
          doc.line(margin, y, margin+100, y);
          y += 12;              // espaço abaixo da linha
        });
      }

      // Cabeçalho
      doc.setFontSize(18).setFont('helvetica','bold').setTextColor(47,79,36);
      doc.text('Documento Detalhado do Projeto', margin, y);
      y += 14;

      // 1. Iniciação
      sectionHeader('1. Iniciação do Projeto');
      printField('TAP', 'tap');
      printField('Registro das Partes Interessadas', 'partesInteressadasIni');
      printField('Responsáveis', 'respIniciacao');
      printSignatures('Assinatura Resp.', 'respIniciacao');
      printField('Cientes', 'cientesIniciacao');
      printSignatures('Assinatura Ciente', 'cientesIniciacao');

      // 2. Planejamento
      sectionHeader('2. Planejamento');
      printField('Plano de Gerenciamento do Projeto', 'planoGerenciamento');
      printField('Escopo', 'escopo');
      printField('Cronograma', 'cronograma');
      printField('Custos', 'custos');
      printField('Qualidade', 'qualidade');
      printField('Riscos', 'riscosPlanej');
      printField('Comunicação', 'comunPlanej');
      printField('Recursos', 'recursos');
      printField('Aquisições', 'aquisicoes');
      printField('Partes Interessadas', 'partesPlanej');
      printField('Responsáveis', 'respPlanejamento');
      printSignatures('Assinatura Resp.', 'respPlanejamento');
      printField('Cientes', 'cientesPlanejamento');
      printSignatures('Assinatura Ciente', 'cientesPlanejamento');

      // 3. Execução & Monitoramento
      sectionHeader('3. Execução e Monitoramento');
      printField('Registro de Riscos', 'registroRiscos');
      printField('Issues Log', 'registroProblemas');
      printField('Change Log', 'registroMudancas');
      printField('Relatórios de Status/Desempenho', 'relatoriosStatus');
      printField('Painel de Indicadores (KPIs)', 'painelKpis');
      printField('Plano de Comunicação', 'planoComunicacao');
      printField('Gestão de Tarefas e Entregas', 'gestaoTarefas');
      printField('Responsáveis', 'respExecucao');
      printSignatures('Assinatura Resp.', 'respExecucao');
      printField('Cientes', 'cientesExecucao');
      printSignatures('Assinatura Ciente', 'cientesExecucao');

      // 4. Encerramento
      sectionHeader('4. Encerramento');
      printField('Termo de Encerramento', 'termoEncerramento');
      printField('Relatório Final do Projeto', 'relatorioFinal');
      printField('Lições Aprendidas', 'licoesAprendidas');
      printField('Documentação de Aceite das Entregas', 'docAceite');
      printField('Plano de Transição/Operação', 'planoTransicao');
      printField('Responsáveis', 'respEncerramento');
      printSignatures('Assinatura Resp.', 'respEncerramento');
      printField('Cientes', 'cientesEncerramento');
      printSignatures('Assinatura Ciente', 'cientesEncerramento');

      doc.save('Projeto_Detalhado_Tecparts.pdf');
    });
  </script>
</body>
</html>
